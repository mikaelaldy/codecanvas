{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file://C%3A/side%20projects/CodeCanvas/codecanvas/src/app/api/explain/route.ts"],"sourcesContent":["import { GoogleGenerativeAI } from '@google/generative-ai';\r\n\r\n// Initialize the Google AI client\r\nconst genAI = new GoogleGenerativeAI(process.env.GOOGLE_AI_API_KEY || '');\r\n\r\nexport async function POST(req: Request) {\r\n  const { prompt, language } = await req.json();\r\n\r\n  // Get the generative model with correct model name\r\n  const model = genAI.getGenerativeModel({ \r\n    model: 'gemini-1.5-flash',  // Using the latest recommended model\r\n    generationConfig: {\r\n      temperature: 0.7,\r\n      topK: 40,\r\n      topP: 0.95,\r\n      maxOutputTokens: 1024,\r\n    },\r\n  });\r\n\r\n  try {\r\n    // Start the generation with language-specific prompt\r\n    const result = await model.generateContentStream(`\r\n      Please explain the following ${language} code in a clear and concise way. \r\n      Focus on:\r\n      1. The main logic and functionality\r\n      2. Key language-specific features used\r\n      3. Any important patterns or best practices\r\n      4. Potential edge cases or considerations\r\n      \r\n      Use simple analogies where appropriate to help understand the code better.\r\n      Format your explanation with clear sections and bullet points where helpful.\r\n      \r\n      Code:\r\n      ${prompt}\r\n    `);\r\n\r\n    // Create a TransformStream to handle the streaming response\r\n    const stream = new TransformStream();\r\n    const writer = stream.writable.getWriter();\r\n\r\n    // Process the stream\r\n    (async () => {\r\n      try {\r\n        for await (const chunk of result.stream) {\r\n          const text = chunk.text();\r\n          if (text) {\r\n            // Format the chunk as a simple text stream\r\n            await writer.write(new TextEncoder().encode(text));\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('Error processing stream:', error);\r\n        await writer.write(new TextEncoder().encode('Error generating explanation. Please try again.'));\r\n      } finally {\r\n        await writer.close();\r\n      }\r\n    })();\r\n\r\n    // Return the stream with proper headers\r\n    return new Response(stream.readable, {\r\n      headers: {\r\n        'Content-Type': 'text/event-stream',\r\n        'Cache-Control': 'no-cache',\r\n        'Connection': 'keep-alive',\r\n      },\r\n    });\r\n  } catch (error) {\r\n    console.error('Error in API route:', error);\r\n    return new Response(\r\n      JSON.stringify({ error: 'Failed to generate explanation' }),\r\n      { status: 500, headers: { 'Content-Type': 'application/json' } }\r\n    );\r\n  }\r\n} "],"names":[],"mappings":";;;AAAA;;AAEA,kCAAkC;AAClC,MAAM,QAAQ,IAAI,gKAAA,CAAA,qBAAkB,CAAC,QAAQ,GAAG,CAAC,iBAAiB,IAAI;AAE/D,eAAe,KAAK,GAAY;IACrC,MAAM,EAAE,MAAM,EAAE,QAAQ,EAAE,GAAG,MAAM,IAAI,IAAI;IAE3C,mDAAmD;IACnD,MAAM,QAAQ,MAAM,kBAAkB,CAAC;QACrC,OAAO;QACP,kBAAkB;YAChB,aAAa;YACb,MAAM;YACN,MAAM;YACN,iBAAiB;QACnB;IACF;IAEA,IAAI;QACF,qDAAqD;QACrD,MAAM,SAAS,MAAM,MAAM,qBAAqB,CAAC,CAAC;mCACnB,EAAE,SAAS;;;;;;;;;;;MAWxC,EAAE,OAAO;IACX,CAAC;QAED,4DAA4D;QAC5D,MAAM,SAAS,IAAI;QACnB,MAAM,SAAS,OAAO,QAAQ,CAAC,SAAS;QAExC,qBAAqB;QACrB,CAAC;YACC,IAAI;gBACF,WAAW,MAAM,SAAS,OAAO,MAAM,CAAE;oBACvC,MAAM,OAAO,MAAM,IAAI;oBACvB,IAAI,MAAM;wBACR,2CAA2C;wBAC3C,MAAM,OAAO,KAAK,CAAC,IAAI,cAAc,MAAM,CAAC;oBAC9C;gBACF;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,4BAA4B;gBAC1C,MAAM,OAAO,KAAK,CAAC,IAAI,cAAc,MAAM,CAAC;YAC9C,SAAU;gBACR,MAAM,OAAO,KAAK;YACpB;QACF,CAAC;QAED,wCAAwC;QACxC,OAAO,IAAI,SAAS,OAAO,QAAQ,EAAE;YACnC,SAAS;gBACP,gBAAgB;gBAChB,iBAAiB;gBACjB,cAAc;YAChB;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,IAAI,SACT,KAAK,SAAS,CAAC;YAAE,OAAO;QAAiC,IACzD;YAAE,QAAQ;YAAK,SAAS;gBAAE,gBAAgB;YAAmB;QAAE;IAEnE;AACF","debugId":null}}]
}